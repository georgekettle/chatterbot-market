<%# Add message partial to the chat: %>
<%= turbo_stream.append dom_id(@chat, :messages) do %>
  <%= render "message", message: @message, scroll_to: true %>
<% end %>
<%# Replace message form: %>
<% if @message.persisted? %>
  <%= turbo_stream.replace dom_id(@chat, :message_form), partial: 'messages/form', locals: { chat: @chat, message: Message.new } %>
<% else %>
  <%= turbo_stream.replace dom_id(@chat, :message_form), partial: 'messages/form', locals: { chat: @chat, message: @message } %>
<% end %>