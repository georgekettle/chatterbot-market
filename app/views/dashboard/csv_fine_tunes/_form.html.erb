<% form_url = csv_fine_tune.persisted? ? csv_fine_tune_path(csv_fine_tune) : dashboard_chatbot_csv_fine_tunes_path(chatbot) %>

<%= form_with model: csv_fine_tune, url: form_url, data: { turbo_frame: :_top } do |f| %>
  <div class="input-spacer">
    <%= render 'components/forms/errors', object: csv_fine_tune, form: f %>
    <%# Description %>
    <div>
      <div class="flex items-baseline space-x-2">
        <%= f.label :description %>
        <span class="text-tertiary-500 text-xs">
          (Optional)
        </span>
      </div>
      <%= f.text_field :description, placeholder: 'Add a description to help identify this file' %>
    </div>
    <%# CSV file %>
    <div>
      <%= f.label :csv_file, 'Upload CSV file' %>
      <% if csv_fine_tune.csv_file.attached? %>
        <div data-controller="reveal" data-reveal-hidden-class="hidden">
          <div data-reveal-target="item">
            <div class="p-3 border border-tertiary-300 rounded shadow-sm flex items-center justify-between">
              <div class="space-y-1">
                <p class="text-xs font-medium text-tertiary-500 flex items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 shrink-0 mr-1">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-11.25a.75.75 0 00-1.5 0v4.59L7.3 9.24a.75.75 0 00-1.1 1.02l3.25 3.5a.75.75 0 001.1 0l3.25-3.5a.75.75 0 10-1.1-1.02l-1.95 2.1V6.75z" clip-rule="evenodd" />
                  </svg>
                  Uploaded file
                </p>
                <p class="text-sm"><%= csv_fine_tune.csv_file.blob.filename %></p>
              </div>
              <button data-action="click->reveal#toggle" type="button" class="btn rounded-full p-2">
                <span class="sr-only">Edit</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                  <path d="M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z" />
                </svg>
              </button>
            </div>
          </div>

          <div class="hidden mt-2" data-reveal-target="item">
            <%= f.file_field :csv_file, accept: 'text/csv' %>
          </div>
        </div>
      <% else %>
        <%= f.file_field :csv_file, accept: 'text/csv' %>
      <% end %>
    </div>
    <%= f.submit (csv_fine_tune.persisted? ? 'Update' : 'Upload'), class: 'w-full' %>
  </div>
<% end %>